{# templates/header.html #}

<!-- Your header-specific styles -->
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/header_style.css') }}"
/>

<header class="header">
  <!-- USP Logo -->
  <a href="{{ url_for('home') }}" class="logo-link">
    <img
      src="{{ url_for('static', filename='images/usp_logo.svg') }}"
      alt="USP Logo"
      class="logo"
    />
  </a>
  
  <!-- User menu -->
  <div class="user-menu">
    <span class="material-icons-outlined user-icon">person</span>
    <ul class="dropdown">
      <li class="dropdown-header">Hi, {{ current_user.username }}</li>
      <li>
        <a id="logout-link" href="{{ url_for('logout') }}">
          <span class="material-icons-outlined mi">logout</span>
          Logout
        </a>
      </li>
    </ul>
  </div>
</header>

<!-- CUSTOM LOGOUT CONFIRM MODAL -->
<div id="logout-modal" class="modal-overlay" style="display:none;">
  <div class="modal-dialog small">
    <p>Are you sure you want to log out?</p>
    <div class="modal-actions">
      <button id="cancel-logout" class="btn btn-secondary">Cancel</button>
      <button id="confirm-logout" class="btn btn-primary">Log Out</button>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // dropdown toggle
    const menu = document.querySelector('.user-menu');
    const icon = menu.querySelector('.user-icon');
    icon.addEventListener('click', e => {
      e.stopPropagation();
      menu.classList.toggle('open');
    });
    document.addEventListener('click', () => menu.classList.remove('open'));

    // modal elements
    const modal = document.getElementById('logout-modal');
    const logoutLink = document.getElementById('logout-link');
    const btnCancel = document.getElementById('cancel-logout');
    const btnConfirm = document.getElementById('confirm-logout');

    logoutLink.addEventListener('click', (e) => {
      e.preventDefault();
      modal.style.display = 'flex';
    });

    btnCancel.addEventListener('click', () => {
      modal.style.display = 'none';
    });

    btnConfirm.addEventListener('click', () => {
      window.location.href = logoutLink.href;
    });
  });
</script>
