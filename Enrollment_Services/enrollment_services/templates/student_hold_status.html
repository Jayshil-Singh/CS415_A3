<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Hold Status</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Align to the top */
            min-height: 100vh;
        }
        .container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            max-width: 700px;
            width: 100%;
            margin-top: 50px; /* Give some space from the top */
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 25px;
        }
        .hold-message {
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            text-align: center;
        }
        .no-hold {
            background-color: #d4edda; /* Light green */
            color: #155724; /* Dark green text */
            border: 1px solid #c3e6cb;
        }
        .active-hold {
            background-color: #f8d7da; /* Light red */
            color: #721c24; /* Dark red text */
            border: 1px solid #f5c6cb;
        }
        .hold-details {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        .hold-details h2 {
            color: #555;
            margin-bottom: 15px;
            font-size: 1.3em;
            text-align: center;
        }
        .hold-details p {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        .restricted-services {
            margin-top: 20px;
        }
        .restricted-services h3 {
            color: #666;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        .restricted-services ul {
            list-style-type: disc;
            padding-left: 25px;
            margin-bottom: 0;
        }
        .restricted-services li {
            margin-bottom: 5px;
            color: #444;
        }
        .important-note {
            background-color: #fff3cd; /* Light yellow */
            border-left: 5px solid #ffc107; /* Yellow border */
            padding: 15px;
            margin-top: 30px;
            border-radius: 4px;
            font-size: 0.95em;
            color: #856404;
        }
        .button-group {
            margin-top: 30px;
            text-align: center;
        }
        .button-group a {
            display: inline-block;
            padding: 10px 20px;
            text-decoration: none;
            background-color: #007bff;
            color: white;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        .button-group a:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Your Student Hold Status</h1>

        {% if hold_status %}
            <div class="hold-message active-hold">
                <p><strong>IMPORTANT:</strong> You currently have an active hold on your account.</p>
                <p>This may restrict your access to certain university services.</p>
            </div>

            <div class="hold-details">
                <h2>Hold Details:</h2>
                <p><strong>Reason for Hold:</strong> {{ hold_status.reason }}</p> {# Corrected from hold_reason #}
                <p><strong>Hold Imposed On:</strong> {{ hold_status.holdDate.strftime('%Y-%m-%d') }}</p> {# Corrected from date_imposed #}
                {% if hold_status.imposed_by_user %}
                    <p><strong>Imposed By:</strong> {{ hold_status.imposed_by_user.username }}</p> {# Or admin's name #}
                {% endif %}

                {% if restricted_services %}
                    <div class="restricted-services">
                        <h3>Restricted Services:</h3>
                        <ul>
                            {% for service in restricted_services %}
                                <li>{{ service.service_name.replace('_', ' ').title() }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                {% else %}
                    <p>No specific services are restricted by this hold at the moment, but it's important to resolve it.</p>
                {% endif %}

                <div class="important-note">
                    <p><strong>What to do next:</strong></p>
                    <p>To resolve this hold and regain full access to all services, please contact the relevant department:</p>
                    {# Note: This logic assumes 'reason' will contain keywords for specific departments #}
                    {% if "payment" in hold_status.reason.lower() %}
                        <p>For non-payment of fees, please contact the **Finance Office** at [Finance Contact Info/Link].</p>
                    {% elif "academic" in hold_status.reason.lower() %}
                        <p>For academic-related holds, please contact your **Faculty Administration** or Academic Advisor at [Faculty Contact Info/Link].</p>
                    {% else %}
                        <p>For other hold reasons, please contact the **Student Affairs Office** at [Student Affairs Contact Info/Link] for clarification and resolution steps.</p>
                    {% endif %}
                    <p>Provide your Student ID when contacting them.</p>
                </div>
            </div>
        {% else %}
            <div class="hold-message no-hold">
                <p><strong>Good News!</strong> You currently have no active holds on your student account.</p>
                <p>You have full access to all available university services.</p>
            </div>
            <div class="important-note">
                <p>To ensure your account remains in good standing, please keep your fee payments up to date and adhere to all university policies and regulations.</p>
            </div>
        {% endif %}

        <div class="button-group">
            {# FIX: Changed url_for to point to the correct blueprint endpoint #}
            <a href="{{ url_for('enrollment.dashboard') }}">Go to Dashboard</a>
        </div>
    </div>
</body>
</html>